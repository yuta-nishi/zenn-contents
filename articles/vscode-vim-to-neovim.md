---
title: "VSCodeVimã‹ã‚‰VSCode Neovimã«ç§»è¡Œã—ãŸã®ã§ãƒ¡ãƒ¢"
emoji: "ğŸ“"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: [Vim, Neovim, VSCode]
published: true
---

## ã¯ã˜ã‚ã«

ã“ã‚“ã«ã¡ã¯ã€[VSCodeVim](https://marketplace.visualstudio.com/items?itemName=vscodevim.vim)ã‹ã‚‰[VSCode Neovim](https://marketplace.visualstudio.com/items?itemName=asvetliakov.vscode-neovim)ã«ç§»è¡Œã—ãŸã®ã§ã€ãã‚Œã«é–¢ã™ã‚‹ãƒ¡ãƒ¢ã‚’ã¾ã¨ã‚ã¾ã—ãŸã€‚

Neovimã®ç’°å¢ƒã¯[LazyVim](https://github.com/LazyVim/LazyVim)ã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™ã€‚ãã®ä»–ã®ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹å ´åˆã¯é©å®œèª­ã¿æ›¿ãˆã¦ãã ã•ã„ã€‚

@[card](https://marketplace.visualstudio.com/items?itemName=vscodevim.vim)
@[card](https://marketplace.visualstudio.com/items?itemName=asvetliakov.vscode-neovim)

:::message
å…¨ä½“ã®è¨­å®šã¯ç§ã®[dotfiles](https://github.com/yuta-nishi/dotfiles)ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚
:::

## ãªãœç§»è¡Œã‚’è€ƒãˆãŸã‹

æ™®æ®µã‹ã‚‰Vimã‚¨ãƒ‡ã‚£ã‚¿ã¯ä½¿ç”¨ã›ãšã€VSCodeVimã‚’ç”¨ã„ã¦VS Codeã§ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚’ã—ã¾ã—ãŸã€‚

ãŸã ã€`.`ã§ã®ç¹°ã‚Šè¿”ã—ã‚„`:`ã‚’ç”¨ã„ãŸã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ã„ã“ãªã›ã¦ãŠã‚‰ãšã€Vimã‚’ã¡ã‚ƒã‚“ã¨å‹‰å¼·ã—ãŸã„ãªã¨æ€ã„ã€æœ€è¿‘ã«ãªã£ã¦[crafzdogã•ã‚“ã®è¨­å®š](https://www.devas.life/effective-neovim-setup-for-web-development-towards-2024/)ã‚’å‚è€ƒã«LazyVimã‚’ç”¨ã„ãŸ[Neovim](https://neovim.io/)ã®ç’°å¢ƒã‚’æ•´ãˆã¦å°‘ã—è§¦ã£ã¦ã„ã¾ã—ãŸã€‚

@[card](https://www.devas.life/effective-neovim-setup-for-web-development-towards-2024/)

çµå±€ã€GitHub Copilot Chatã‚„Remote SSHãªã©ã®æœ‰ç”¨ãªæ‹¡å¼µæ©Ÿèƒ½ãŒæ‰‹æ”¾ã›ãªã„ã®ã§VS Codeã‚’åˆ©ç”¨ã™ã‚‹ã“ã¨ã«ã—ãŸã®ã§ã™ãŒã€Neovimã‚’è§¦ã£ãŸã“ã¨ã§VSCodeVimã®ã‚‚ã£ã•ã‚Šæ„ŸãŒæ°—ã«ãªã£ãŸãŸã‚ã€VSCode Neovimã«ç§»è¡Œã™ã‚‹ã“ã¨ã‚’è€ƒãˆã¾ã—ãŸã€‚

## ç§»è¡Œã™ã‚‹ãƒ¡ãƒªãƒƒãƒˆ

VSCodeVimã¨VSCode Neovimã®é•ã„ã¯[yubrotã•ã‚“ã®è¨˜äº‹](https://zenn.dev/yubrot/articles/1bf4b8d79d7cae)ã«ã¾ã¨ã¾ã£ã¦ã„ã¾ã™ã®ã§ã€ã“ã¡ã‚‰ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

@[card](https://zenn.dev/yubrot/articles/1bf4b8d79d7cae)

ç­†è€…ã®VSCodeVimç’°å¢ƒã§ã¯undoãŒå£Šã‚Œã‚‹ã¨ã„ã†ã“ã¨ã¯ã‚ã‚Šã¾ã›ã‚“ã§ã—ãŸãŒã€ã‚«ãƒ¼ã‚½ãƒ«ã®ç§»å‹•ãŒã‚‚ã£ã•ã‚Šã—ãŸã‚Šã€SaveãŒé‡ããªã£ãŸã‚Šã™ã‚‹ã“ã¨ãŒã‚ã£ãŸã®ã§ã€ã‚„ã¯ã‚ŠVSCode Neovimã‚ˆã‚Šã¯åŠ£ã£ã¦ã„ã‚‹ã‚ˆã†ã«æ„Ÿã˜ã¾ã™ã€‚

ç‰¹ã«ã€ä»¥ä¸‹ã®ã‚ˆã†ã«`:h`ãªã©ã®ä¸»è¦ã‚³ãƒãƒ³ãƒ‰ãŒå®Ÿè£…ã•ã‚Œã¦ã„ãªã‹ã£ãŸã‚Šã€ã‚³ãƒãƒ³ãƒ‰ã®å…¥åŠ›ãŒåˆ†ã‹ã‚Šã‚„ã™ãè¡¨ç¤ºã•ã‚Œãªã„ã®ã¯æˆ‘æ…¢ã§ãã¾ã›ã‚“ã§ã—ãŸã€‚ãã®ç‚¹ã€VSCode Neovimã¯ãã¡ã‚“ã¨å‹•ä½œã—ã¾ã™ã€‚

![VSCode Neovimã®å ´åˆ](/images/vscode-vim-to-neovim-1.png =500x)
*VSCode Neovimã§ã‚³ãƒãƒ³ãƒ‰ã‚’æ‰“ã¤ã¨ä¸Šéƒ¨ã«è¡¨ç¤ºã•ã‚Œã€è¦‹ã‚„ã™ã„*

![VSCodeVimã®å ´åˆ](/images/vscode-vim-to-neovim-2.png =500x)
*VSCodeVimã§ã‚³ãƒãƒ³ãƒ‰ã‚’æ‰“ã¤ã¨ä¸‹éƒ¨ã«è¡¨ç¤ºã•ã‚Œã€å¯¾å¿œã—ã¦ã„ãªã„ã‚³ãƒãƒ³ãƒ‰ã‚‚ã‚ã‚‹*

## VSCodeVimã®è¨­å®š

VSCodeVimã¯ä»¥ä¸‹ã®ã‚ˆã†ã«è¨­å®šã—ã¦ã„ã¾ã—ãŸã€‚
å°‘ã—é•·ã„ã§ã™ã€‚

```json:settings.json
/* Vim Settings */
  "vim.hlsearch": true,
  "vim.easymotion": true,
  "vim.leader": "<space>",
  "vim.useSystemClipboard": true,
  "vim.visualstar": true,
  "vim.camelCaseMotion.enable": true,
  "vim.insertModeKeyBindings": [
    {
      "before": [
        "j",
        "k"
      ],
      "after": [
        "<ESC>"
      ]
    }
  ],
  "vim.normalModeKeyBindings": [
    {
      "before": [
        "u"
      ],
      "commands": [
        {
          "command": "undo"
        }
      ]
    },
    {
      "before": [
        "<C-r>"
      ],
      "commands": [
        {
          "command": "redo"
        }
      ]
    },
    {
      "before": [
        "j"
      ],
      "after": [
        "g",
        "j"
      ]
    },
    {
      "before": [
        "k"
      ],
      "after": [
        "g",
        "k"
      ]
    },
    {
      "before": [
        "n"
      ],
      "after": [
        "n",
        "z",
        "z"
      ]
    },
    {
      "before": [
        "N"
      ],
      "after": [
        "N",
        "z",
        "z"
      ]
    },
    {
      "before": [
        "*"
      ],
      "after": [
        "*",
        "z",
        "z"
      ]
    },
    {
      "before": [
        "#"
      ],
      "after": [
        "#",
        "z",
        "z"
      ]
    },
    {
      "before": [
        "+"
      ],
      "after": [
        "<C-a>"
      ]
    },
    {
      "before": [
        "-"
      ],
      "after": [
        "<C-x>"
      ]
    },
    {
      "before": [
        "<Leader>",
        "/"
      ],
      "commands": [
        {
          "command": "editor.action.commentLine"
        }
      ]
    },
    {
      "before": [
        "<Leader>",
        "s"
      ],
      "after": [],
      "commands": [
        {
          "command": "workbench.action.files.save",
        }
      ]
    },
    {
      "before": [
        "<Leader>",
        "w"
      ],
      "after": [],
      "commands": [
        {
          "command": "workbench.action.closeActiveEditor",
        }
      ]
    },
    {
      "before": [
        "<C-h>",
      ],
      "after": [
        "^"
      ]
    },
    {
      "before": [
        "<C-l>",
      ],
      "after": [
        "$"
      ]
    },
    {
      "before": [
        "<Leader>",
        "m"
      ],
      "after": [
        "%"
      ]
    },
    {
      "before": [
        "<Leader>",
        "z"
      ],
      "commands": [
        ":noh"
      ]
    }
  ],
  "vim.visualModeKeyBindings": [
    {
      "before": [
        "<C-h>",
      ],
      "after": [
        "^"
      ]
    },
    {
      "before": [
        "<C-l>",
      ],
      "after": [
        "$"
      ]
    },
    {
      "before": [
        "<Leader>",
        "m"
      ],
      "after": [
        "%"
      ]
    },
  ]
```

ã“ã®è¨­å®šã¯[Vimmerã®Vimmerã«ã‚ˆã‚‹Vimmerã®ãŸã‚ã®VSCodeç’°å¢ƒæ§‹ç¯‰](https://fe-notes.work/posts/20200708_vsvim01/)ã‚’å‚è€ƒã«ã—ã¦ã„ã¾ã™ã€‚
ä¸Šè¨˜ã®è¨­å®šã‚’VSCode Neovimã§åŒã˜ã‚ˆã†ã«è¨­å®šã—ã¾ã™ã€‚

@[card](https://fe-notes.work/posts/20200708_vsvim01/)

## VSCode Neovimã®è¨­å®š

### `settings.json`

VSCode Neovimã¯ãƒ­ãƒ¼ã‚«ãƒ«ã®Neovimã¨è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«è¨­å®šã—ã¦èª­ã¿è¾¼ã¿ã¾ã™ã€‚

```json:settings.json
  "vscode-neovim.neovimExecutablePaths.darwin": "/opt/homebrew/bin/nvim",
  "vscode-neovim.neovimInitVimPaths.darwin": "/Users/yutanishi/.config/nvim/init.lua",
```

### `init.lua`

pathã«æŒ‡å®šã—ãŸ`init.lua`ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«è¨­å®šã—ã¦ã„ã¾ã™ã€‚

```lua:init.lua
require("config.lazy")
```

### `lazy.lua`

`lazy.lua`ã§ã®æ¡ä»¶åˆ†å²ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«è¨­å®šã—ã¦ã„ã¾ã™ã€‚

```lua:lazy.luaã®æŠœç²‹
-- Set up lazy.nvim
if not vim.g.vscode then
  require("lazy").setup({
    spec = {
      -- LazyVim core plugins
      {
        "LazyVim/LazyVim",
        import = "lazyvim.plugins",
        opts = {
          colorscheme = "everforest",
          news = { lazyvim = true, neovim = true },
        },
      },

      -- Import extra modules
      { import = "lazyvim.plugins.extras.linting.eslint" },
      { import = "lazyvim.plugins.extras.formatting.prettier" },
      { import = "lazyvim.plugins.extras.lang.typescript" },
      { import = "lazyvim.plugins.extras.lang.json" },
      { import = "lazyvim.plugins.extras.lang.rust" },
      { import = "lazyvim.plugins.extras.coding.copilot" },
      { import = "lazyvim.plugins.extras.util.mini-hipatterns" },
      { import = "plugins" },
    },

    defaults = {
      -- Don't lazy-load custom plugins by default
      lazy = false,
      -- Use the latest git commit
      version = false,
    },

    checker = {
      -- Automatically check for plugin updates
      enabled = true,
    },

    performance = {
      cache = {
        -- Enable caching for all plugins
        enabled = true,
      },
      rtp = {
        -- Disable some rtp plugins
        disabled_plugins = {
          "gzip",
          "netrwPlugin",
          "rplugin",
          "tarPlugin",
          "tohtml",
          "tutor",
          "zipPlugin",
        },
      },
    },

    debug = false,
  })
else
  require("config.keymaps")
  require("config.options")
  require("lazy").setup({
    -- Surround plugin
    {
      "kylechui/nvim-surround",
      version = "*", -- Use for stability; omit to use `main` branch for the latest features
      event = "VeryLazy",
      config = function()
        require("nvim-surround").setup({
          -- Configuration here, or leave empty to use defaults
        })
      end
    }
  })
end
```

`vim.g.vscode`ã§VSCode Neovimã‚’ä½¿ç”¨ã™ã‚‹å ´åˆã®åˆ¤å®šã‚’ã—ã¦ã„ã¾ã™ã€‚`lazy.nvim`ã¨`packer.nvim`ã§ã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§æä¾›ã•ã‚Œã¦ã„ã‚‹ã®ã§æ¥½ã§ã™ã€‚

`keymaps`ã¨`options`ã‚’æœ‰åŠ¹ã«ã—ã¦ã„ã¾ã™ã€‚
ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã¯`nvim-surround`ã ã‘å…¥ã‚Œã¦ã„ã¾ã™ã€‚

å‚è€ƒï¼š
@[card](https://github.com/vscode-neovim/vscode-neovim?tab=readme-ov-file#neovim-configuration)

:::message
è‡ªåˆ†ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆã¯ä»¥ä¸‹ã§ã™ã€‚

- init.lua
- lua
  - config
    - autocmds.lua
    - keymaps.lua
    - lazy.lua
    - options.lua
  - plugins
    - colorscheme.lua
    - ...
:::

### `keymaps.lua`

`keymaps.lua`ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«è¨­å®šã—ã¦ã„ã¾ã™ã€‚

```lua:keymaps.lua
local keymap = vim.keymap
local opts = { noremap = true, silent = true }

-- Insert mode mapping
keymap.set("i", "jk", "<ESC>", opts)

-- Normal mode mappings
keymap.set("n", "<C-h>", "^", opts)
keymap.set("n", "<C-l>", "$", opts)

-- To avoid easymotion
keymap.set("n", "s", '"_s', opts)

-- Visual mode mappings
keymap.set("v", "<C-h>", "^", opts)
keymap.set("v", "<C-l>", "$", opts)
```

### `options.lua`

`options.lua`ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«è¨­å®šã—ã¦ã„ã¾ã™ã€‚
ãŸã ã€å…ƒã€…å¤šãã®è¨­å®šã‚’ã—ã¦ã„ã‚‹ã®ã§ã©ã‚ŒãŒåæ˜ ã•ã‚Œã¦ã„ã‚‹ã‹åˆ†ã‹ã£ã¦ã„ã¾ã›ã‚“ã€‚
æ„å›³çš„ã«è¿½åŠ ã—ãŸè¨­å®šã‚’æŠœç²‹ã—ã¦ã„ã¾ã™ã€‚

```lua:options.luaã®æŠœç²‹
vim.g.mapleader = " "
vim.opt.clipboard = "unnamedplus"
```

## è¨­å®šã§è©°ã¾ã£ãŸã¨ã“ã‚

Neovimç§»è¡Œã§è©°ã¾ã£ãŸã¨ã“ã‚ã¯ä»¥ä¸‹ã®3ç‚¹ã§ã™ã€‚

### insert mode mappingãŒåæ˜ ã•ã‚Œãªã„

`keymaps.lua`ã®è¨­å®šã‚’å…ˆè¿°ã—ã¾ã—ãŸãŒã€VSCode Neovimã§ã¯insert modeã«å¯¾ã™ã‚‹ã‚«ã‚¹ã‚¿ãƒ ãƒãƒƒãƒ”ãƒ³ã‚°è¨­å®šã¯é©ç”¨ã§ãã¾ã›ã‚“ã€‚å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®é€šã‚Šã«`settings.json`ã‚’è¨­å®šã—ã¦è§£æ±ºã—ã¾ã—ãŸã€‚

:::message alert
å…ƒã€…ã€`keybindings.json`ã«è¨­å®šã‚’è¨˜è¼‰ã—ã¦ã„ã¾ã—ãŸãŒã€V1.11.0ã‹ã‚‰`settings.json`ã«è¨˜è¼‰ã™ã‚‹ã‚ˆã†ã«å¤‰æ›´ã•ã‚Œã¾ã—ãŸã€‚
:::

@[card](https://github.com/vscode-neovim/vscode-neovim/pull/1917)
@[card](https://github.com/vscode-neovim/vscode-neovim?tab=readme-ov-file#composite-escape-keys)

```json:settings.jsonã®æŠœç²‹
  "vscode-neovim.compositeKeys": {
    "jk": {
      "command": "vscode-neovim.escape",
    }
  },
```

### Spaceã‚’Leaderã«å‰²ã‚Šå½“ã¦ã‚‰ã‚Œãªã„

`options.lua`ã«`vim.g.mapleader = " "`ã‚’è¨­å®šã—ã¦ã„ã‚‹ã®ã§SpaceãŒLeaderã«å‰²ã‚Šå½“ã¦ã‚‰ã‚Œã¦ã„ã¾ã™ã€‚ã—ã‹ã—ã€VSCode Neovimã§ã¯Leaderã‚’ç”¨ã„ãŸæ“ä½œãŒæƒ³å®šã•ã‚Œã¦ã„ãªã„ã‚ˆã†ã§ã“ã®è¨­å®šã¯åæ˜ ã•ã‚Œã¾ã›ã‚“ã§ã—ãŸã€‚

ä»•æ–¹ãªã„ã®ã§ã€Spaceã‚’ç”¨ã„ãŸVS Codeã®æ“ä½œã¯`keybindings.json`ã§è¨­å®šã—ã¦è§£æ±ºã—ã¾ã—ãŸã€‚

```json:keybindings.jsonã®æŠœç²‹
  {
    "key": "space s",
    "command": "workbench.action.files.save",
    "when": "neovim.mode == normal && editorTextFocus"
  },
  {
    "key": "space /",
    "command": "editor.action.commentLine",
    "when": "neovim.mode == normal && editorTextFocus"
  },
  {
    "key": "space w",
    "command": "workbench.action.closeActiveEditor",
    "when": "neovim.mode == normal && editorTextFocus"
  }
```

### yankãŒclipboardã«ã‚³ãƒ”ãƒ¼ã•ã‚Œãªã„

å…ƒã€…ã®LazyVimã§ã¯ã‚«ã‚¹ã‚¿ãƒ ã®è¨­å®šã‚’è¿½åŠ ã—ãªãã¦ã‚‚yankãŒclipboardã«ã‚³ãƒ”ãƒ¼ã•ã‚Œã¦ã„ã¾ã—ãŸã€‚
å¤šåˆ†LazyVimã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®è¨­å®šã§ãã†ãªã£ã¦ã„ãŸã®ã§ã€VSCode Neovimã§ã‚‚ã‚³ãƒ”ãƒ¼ã•ã‚Œã‚‹ã‚ˆã†ã«`options.lua`ã§æ˜ç¤ºçš„ã«è¨­å®šã—ã¾ã—ãŸã€‚

```lua:options.luaã®æŠœç²‹
vim.opt.clipboard = "unnamedplus"
```

## è§£æ±ºã§ããªã‹ã£ãŸã“ã¨

VSCode Neovimã¯Leaderã®è¨­å®šãŒåæ˜ ã•ã‚Œãªã‹ã£ãŸã®ã§ã€ä¸‹è¨˜ã®ã‚ˆã†ã«VS Codeã®æ©Ÿèƒ½ã§ã¯ãªã„Leaderã‚’ç”¨ã„ãŸã‚«ã‚¹ã‚¿ãƒ ã‚­ãƒ¼ãƒã‚¤ãƒ³ãƒ‰ãŒé©ç”¨ã§ãã¾ã›ã‚“ã§ã—ãŸã€‚**ã‚‚ã—ã‚ã‹ã‚‹æ–¹ãŒã„ã‚‰ã£ã—ã‚ƒã‚Œã°ã€ã‚³ãƒ¡ãƒ³ãƒˆã—ã¦ã„ãŸã ã‘ã‚‹ã¨å¬‰ã—ã„ã§ã™ã€‚**

ãŸã ã€æ™®æ®µã‹ã‚‰ã‚ã¾ã‚Šä½¿ã‚ãªã„è¨­å®šã°ã‹ã‚Šã ã£ãŸã®ã§ã€ãƒ€ãƒ¡ãƒ¼ã‚¸ã¯0ã§ã™ã€‚

```json:settings.jsonã®æŠœç²‹
    {
      "before": [
        "<Leader>",
        "m"
      ],
      "after": [
        "%"
      ]
    }
```

## ã•ã„ã”ã«

VSCode Neovimã«ç§»è¡Œã—ã¦å¿«é©ã«ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ãŒã§ãã¦ã„ã¾ã™ã€‚æº€è¶³ã§ã™ã€‚
Neovimã®æ“ä½œæ„ŸãŒæ¬²ã—ã„ã‘ã©ã€ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®ç®¡ç†ãŒé¢å€’ãã•ã„ã¨ã„ã†æ–¹ã«ãŠã™ã™ã‚ã§ã™ã€‚
