---
title: "VSCodeVimã‹ã‚‰VSCode Neovimã«ç§»è¡Œã—ãŸã®ã§ãƒ¡ãƒ¢"
emoji: "ğŸ“"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: [Vim, Neovim, VSCode]
published: false
---

## ã¯ã˜ã‚ã«

ã“ã‚“ã«ã¡ã¯ã€ä»Šå›ã¯[VSCodeVim](https://marketplace.visualstudio.com/items?itemName=vscodevim.vim)ã‹ã‚‰[VSCode Neovim](https://marketplace.visualstudio.com/items?itemName=asvetliakov.vscode-neovim)ã«ç§»è¡Œã—ãŸã®ã§ã€ãã‚Œã«é–¢ã™ã‚‹ãƒ¡ãƒ¢ã‚’ã¾ã¨ã‚ã¦è¨˜äº‹ã«ã—ã¦ã„ã¾ã™ã€‚

Neovimã®ç’°å¢ƒã¯[LazyVim](https://github.com/LazyVim/LazyVim)ã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™ã€‚ãã®ä»–ã®ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹å ´åˆã¯é©å®œèª­ã¿æ›¿ãˆã¦ãã ã•ã„ã€‚

@[card](https://marketplace.visualstudio.com/items?itemName=vscodevim.vim)
@[card](https://marketplace.visualstudio.com/items?itemName=asvetliakov.vscode-neovim)

:::message alert
Vimã®ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’VS Codeã§ä½¿ãˆã‚‹ã‚ˆã†ã«ã™ã‚‹è¨­å®šã¯ã—ã¦ã„ã¾ã›ã‚“ã€‚
keymapsã¨optionsã‚’è¨­å®šã—ã¾ã™ã€‚
:::

:::message
å…¨ä½“ã®è¨­å®šã¯ç§ã®[dotfiles](https://github.com/yuta-nishi/dotfiles/tree/main)ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚
:::

## ã“ã®è¨˜äº‹ã®ä¸»ãªå¯¾è±¡èª­è€…

- VSCodeVimã‚’ä½¿ã£ã¦ã„ã‚‹æ–¹
- VSCode Neovimã«èˆˆå‘³ãŒã‚ã‚‹æ–¹

## ãªãœç§»è¡Œã‚’è€ƒãˆãŸã‹

ã¾ãšã€ç­†è€…ã®Vimæ­´ã¯**1å¹´å¼±ç¨‹åº¦**ã§ã™ã€‚æ™®æ®µã‹ã‚‰Vimã‚¨ãƒ‡ã‚£ã‚¿ã¯ä½¿ç”¨ã›ãšã€VSCodeVimã‚’ç”¨ã„ã¦VS Codeã§ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚’ã—ã¦ã„ã¾ã™ã€‚

ãŸã ã€`.`ã§ã®ç¹°ã‚Šè¿”ã—ã‚„`:`ã‚’ç”¨ã„ãŸã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ã„ã“ãªã›ã¦ãŠã‚‰ãšã€Vimã‚’ã¡ã‚ƒã‚“ã¨å‹‰å¼·ã—ãŸã„ãªã¨æ€ã„ã€æœ€è¿‘ã«ãªã£ã¦[crafzdogã•ã‚“ã®è¨­å®š](https://www.devas.life/effective-neovim-setup-for-web-development-towards-2024/)ã‚’å‚è€ƒã«LazyVimã‚’ç”¨ã„ãŸ[Neovim](https://neovim.io/)ã®ç’°å¢ƒã‚’æ•´ãˆã¦å°‘ã—è§¦ã£ã¦ã„ã¾ã—ãŸã€‚

@[card](https://www.devas.life/effective-neovim-setup-for-web-development-towards-2024/)

çµå±€ã€Copilot Chatã‚„Remote SSHãªã©ã®æœ‰ç”¨ãªæ‹¡å¼µæ©Ÿèƒ½ãŒæ‰‹æ”¾ã›ãªã„ã®ã§VS Codeã‚’åˆ©ç”¨ã™ã‚‹ã“ã¨ã«ã—ãŸã®ã§ã™ãŒã€Neovimã‚’è§¦ã£ãŸã“ã¨ã§VSCodeVimãŒä½¿ã„ã¥ã‚‰ã„ã¨æ„Ÿã˜ãŸãŸã‚ã€VSCode Neovimã«ç§»è¡Œã™ã‚‹ã“ã¨ã‚’è€ƒãˆã¾ã—ãŸã€‚

## ç§»è¡Œã™ã‚‹ãƒ¡ãƒªãƒƒãƒˆ

VSCodeVimã¨VSCode Neovimã®é•ã„ã¯[yubrotã•ã‚“ã®è¨˜äº‹](https://zenn.dev/yubrot/articles/1bf4b8d79d7cae)ã«ã¾ã¨ã¾ã£ã¦ã„ã¾ã™ã®ã§ã€ã“ã¡ã‚‰ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

@[card](https://zenn.dev/yubrot/articles/1bf4b8d79d7cae)

ç­†è€…ã®VSCodeVimç’°å¢ƒã§ã¯undoãŒå£Šã‚Œã‚‹ã¨ã„ã†ã“ã¨ã¯ã‚ã¾ã‚Šã‚ã‚Šã¾ã›ã‚“ã§ã—ãŸãŒã€ã‚«ãƒ¼ã‚½ãƒ«ã®ç§»å‹•ãŒã‚‚ã£ã•ã‚Šã—ãŸã‚Šã€SaveãŒé‡ããªã£ãŸã‚Šã™ã‚‹ã“ã¨ãŒã‚ã£ãŸã®ã§ã€ã‚„ã¯ã‚ŠVSCode Neovimã‚ˆã‚Šã¯åŠ£ã£ã¦ã„ã‚‹ã‚ˆã†ã«æ„Ÿã˜ã¾ã™ã€‚

ç‰¹ã«`:h`ãªã©ã®ä¸»è¦ã‚³ãƒãƒ³ãƒ‰ãŒå®Ÿè£…ã•ã‚Œã¦ã„ãªã‹ã£ãŸã‚Šã€ã‚³ãƒãƒ³ãƒ‰ã®å…¥åŠ›ãŒåˆ†ã‹ã‚Šã‚„ã™ãè¡¨ç¤ºã•ã‚Œãªã„ã®ã¯æˆ‘æ…¢ã§ãã¾ã›ã‚“ã§ã—ãŸã€‚ãã®ç‚¹ã€VSCode Neovimã¯ã“ã®è¦ä»¶ã‚’æº€ãŸã—ã¦ã„ã¾ã™ã€‚

![]()
![]()

## VSCodeVimã®è¨­å®š

VSCodeVimã¯ä»¥ä¸‹ã®ã‚ˆã†ã«è¨­å®šã—ã¦ã„ã¾ã—ãŸã€‚

```json:settings.json
/* Vim Settings */
  "vim.hlsearch": true,
  "vim.easymotion": true,
  "vim.leader": "<space>",
  "vim.useSystemClipboard": true,
  "vim.visualstar": true,
  "vim.camelCaseMotion.enable": true,
  "vim.insertModeKeyBindings": [
    {
      "before": [
        "j",
        "k"
      ],
      "after": [
        "<ESC>"
      ]
    }
  ],
  "vim.normalModeKeyBindings": [
    {
      "before": [
        "u"
      ],
      "commands": [
        {
          "command": "undo"
        }
      ]
    },
    {
      "before": [
        "<C-r>"
      ],
      "commands": [
        {
          "command": "redo"
        }
      ]
    },
    {
      "before": [
        "j"
      ],
      "after": [
        "g",
        "j"
      ]
    },
    {
      "before": [
        "k"
      ],
      "after": [
        "g",
        "k"
      ]
    },
    {
      "before": [
        "n"
      ],
      "after": [
        "n",
        "z",
        "z"
      ]
    },
    {
      "before": [
        "N"
      ],
      "after": [
        "N",
        "z",
        "z"
      ]
    },
    {
      "before": [
        "*"
      ],
      "after": [
        "*",
        "z",
        "z"
      ]
    },
    {
      "before": [
        "#"
      ],
      "after": [
        "#",
        "z",
        "z"
      ]
    },
    {
      "before": [
        "+"
      ],
      "after": [
        "<C-a>"
      ]
    },
    {
      "before": [
        "-"
      ],
      "after": [
        "<C-x>"
      ]
    },
    {
      "before": [
        "<Leader>",
        "/"
      ],
      "commands": [
        {
          "command": "editor.action.commentLine"
        }
      ]
    },
    {
      "before": [
        "<Leader>",
        "s"
      ],
      "after": [],
      "commands": [
        {
          "command": "workbench.action.files.save",
        }
      ]
    },
    {
      "before": [
        "<Leader>",
        "w"
      ],
      "after": [],
      "commands": [
        {
          "command": "workbench.action.closeActiveEditor",
        }
      ]
    },
    {
      "before": [
        "<C-h>",
      ],
      "after": [
        "^"
      ]
    },
    {
      "before": [
        "<C-l>",
      ],
      "after": [
        "$"
      ]
    },
    {
      "before": [
        "<Leader>",
        "m"
      ],
      "after": [
        "%"
      ]
    },
    {
      "before": [
        "<Leader>",
        "z"
      ],
      "commands": [
        ":noh"
      ]
    }
  ],
  "vim.visualModeKeyBindings": [
    {
      "before": [
        "<C-h>",
      ],
      "after": [
        "^"
      ]
    },
    {
      "before": [
        "<C-l>",
      ],
      "after": [
        "$"
      ]
    },
    {
      "before": [
        "<Leader>",
        "m"
      ],
      "after": [
        "%"
      ]
    },
  ]
```

ã“ã®è¨­å®šã¯[Vimmerã®Vimmerã«ã‚ˆã‚‹Vimmerã®ãŸã‚ã®VSCodeç’°å¢ƒæ§‹ç¯‰](https://fe-notes.work/posts/20200708_vsvim01/)ã‚’å‚è€ƒã«ã—ã¦ã„ã¾ã™ã€‚
ä¸Šè¨˜ã®è¨­å®šã‚’VSCode Neovimã§åŒã˜ã‚ˆã†ã«è¨­å®šã—ã¾ã™ã€‚

@[card](https://fe-notes.work/posts/20200708_vsvim01/)

## VSCode Neovimã®è¨­å®š

### `settings.json`

VSCode Neovimã¯ãƒ­ãƒ¼ã‚«ãƒ«ã®Neovimã¨è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«è¨­å®šã—ã¦èª­ã¿è¾¼ã¾ã›ã¾ã™ã€‚

```json:settings.json
  /* NeoVim Settings */
  "vscode-neovim.neovimExecutablePaths.darwin": "/opt/homebrew/bin/nvim",
  "vscode-neovim.neovimInitVimPaths.darwin": "/Users/yutanishi/.config/nvim/init.lua",
```

### `init.lua`

pathã«æŒ‡å®šã—ãŸ`init.lua`ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«è¨­å®šã—ã¦ã„ã¾ã™ã€‚

```lua:init.lua
if vim.g.vscode then
  require("config.keymaps")
  require("config.options")
else
  require("config.lazy")
end
```

`vim.g.vscode`ã§VSCode Neovimã‚’ä½¿ç”¨ã™ã‚‹å ´åˆã®åˆ¤å®šã‚’ã—ã¦ã„ã¾ã™ã€‚
`keymaps`ã¨`options`ã®ã¿ã‚’åæ˜ ã•ã›ãŸã„ã®ã§ä¸Šè¨˜ã®ã‚ˆã†ã«ã—ã¦ã„ã¾ã™ã€‚

:::message
LazyVimã®å ´åˆã€ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆã¯ä»¥ä¸‹ã«ãªã‚Šã¾ã™ã€‚

- init.lua
- lua
  - config
    - autocmds.lua
    - keymaps.lua
    - lazy.lua
    - options.lua
  - plugins
    - colorscheme.lua
    - ...
:::

### `keymaps.lua`

`keymaps.lua`ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«è¨­å®šã—ã¦ã„ã¾ã™ã€‚

```lua:keymaps.lua
local keymap = vim.keymap
local opts = { noremap = true, silent = true }

-- Insert mode mapping
keymap.set("i", "jk", "<ESC>", opts)

-- Normal mode mappings
keymap.set("n", "<C-h>", "^", opts)
keymap.set("n", "<C-l>", "$", opts)

-- Inc/Dec settings
keymap.set("n", "+", "<C-a>", opts)
keymap.set("n", "-", "<C-x>", opts)

-- To avoid easymotion
keymap.set("n", "s", '"_s', opts)

-- Visual mode mappings
keymap.set("v", "<C-h>", "^", opts)
keymap.set("v", "<C-l>", "$", opts)
```

### `options.lua`

`options.lua`ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«è¨­å®šã—ã¦ã„ã¾ã™ã€‚
ãŸã ã€å…ƒã€…å¤šãã®è¨­å®šã‚’ã—ã¦ã„ã‚‹ã®ã§ã©ã‚ŒãŒåæ˜ ã•ã‚Œã¦ã„ã‚‹ã‹åˆ†ã‹ã£ã¦ã„ã¾ã›ã‚“ã€‚
æ„å›³çš„ã«è¿½åŠ ã—ãŸè¨­å®šã‚’æŠœç²‹ã—ã¦ã„ã¾ã™ã€‚

```lua:options.luaã®æŠœç²‹
vim.g.mapleader = " "
vim.opt.clipboard = "unnamedplus"
```

## è¨­å®šã§è©°ã¾ã£ãŸã¨ã“ã‚

Neovimç§»è¡Œã§è©°ã¾ã£ãŸã¨ã“ã‚ã¯ä»¥ä¸‹ã®3ç‚¹ã§ã™ã€‚

### insert mode mappingãŒåæ˜ ã•ã‚Œãªã„

`keymaps.lua`ã®è¨­å®šã‚’å…ˆè¿°ã—ã¾ã—ãŸãŒã€VSCode Neovimã§ã¯insert modeã«å¯¾ã™ã‚‹ã‚«ã‚¹ã‚¿ãƒ ãƒãƒƒãƒ”ãƒ³ã‚°è¨­å®šã¯é©ç”¨ã§ãã¾ã›ã‚“ã€‚[å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://github.com/vscode-neovim/vscode-neovim?tab=readme-ov-file#composite-escape-keys)ã®é€šã‚Šã«`keybindings.json`ã‚’è¨­å®šã—ã¦è§£æ±ºã—ã¾ã—ãŸã€‚

@[card](https://github.com/vscode-neovim/vscode-neovim?tab=readme-ov-file#composite-escape-keys)

```json:keybindings.jsonã®æŠœç²‹
  /* Neovim Settings */
  {
    "key": "j",
    "command": "vscode-neovim.compositeEscape1",
    "when": "neovim.mode == insert && editorTextFocus",
    "args": "j"
  },
  {
    "key": "k",
    "command": "vscode-neovim.compositeEscape2",
    "when": "neovim.mode == insert && editorTextFocus",
    "args": "k"
  }
```

### Spaceã‚’Leaderã«å‰²ã‚Šå½“ã¦ã‚‰ã‚Œãªã„

`options.lua`ã«`vim.g.mapleader = " "`ã‚’è¨­å®šã—ã¦ã„ã‚‹ã®ã§SpaceãŒLeaderã«å‰²ã‚Šå½“ã¦ã‚‰ã‚Œã¦ã„ã¾ã™ã€‚ã—ã‹ã—ã€VSCode Neovimã§ã¯Leaderã‚’ç”¨ã„ãŸæ“ä½œãŒæƒ³å®šã•ã‚Œã¦ã„ãªã„ã‚ˆã†ã§VSCodeVimã®ã‚ˆã†ãªæ“ä½œã¯ã§ãã¾ã›ã‚“ã§ã—ãŸã€‚

ä»•æ–¹ãªã„ã®ã§ã€Spaceã‚’ç”¨ã„ãŸVS Codeã®æ“ä½œã¯`keybindings.json`ã§è¨­å®šã—ã¦è§£æ±ºã—ã¾ã—ãŸã€‚

```json:keybindings.jsonã®æŠœç²‹
  /* Neovim Settings */
  {
    "key": "space s",
    "command": "workbench.action.files.save",
    "when": "neovim.mode == normal && editorTextFocus"
  },
  {
    "key": "space /",
    "command": "editor.action.commentLine",
    "when": "neovim.mode == normal && editorTextFocus"
  },
  {
    "key": "space w",
    "command": "workbench.action.closeActiveEditor",
    "when": "neovim.mode == normal && editorTextFocus"
  }
```

### yankãŒclipboardã«ã‚³ãƒ”ãƒ¼ã•ã‚Œãªã„

å…ƒã€…ã®LazyVimã§ã¯ã‚«ã‚¹ã‚¿ãƒ ã®è¨­å®šã‚’è¿½åŠ ã—ãªãã¦ã‚‚yankãŒclipboardã«ã‚³ãƒ”ãƒ¼ã•ã‚Œã¦ã„ã¾ã—ãŸã€‚
å¤šåˆ†LazyVimå´ã®è¨­å®šã§ãã†ãªã£ã¦ã„ãŸã®ã§ã€VSCode Neovimã§ã‚‚ã‚³ãƒ”ãƒ¼ã•ã‚Œã‚‹ã‚ˆã†ã«`options.lua`ã§æ˜ç¤ºçš„ã«è¨­å®šã—ã¾ã—ãŸã€‚

```lua:options.luaã®æŠœç²‹
vim.opt.clipboard = "unnamedplus"
```

:::message
unnamedã¨unnamedplusã®é•ã„
:::

## è§£æ±ºã§ããªã‹ã£ãŸã“ã¨

VSCode Neovimã¯Leaderã®è¨­å®šãŒåæ˜ ã•ã‚Œãªã‹ã£ãŸã®ã§ã€ä¸‹è¨˜ã®ã‚ˆã†ãªLeaderã‚’ç”¨ã„ãŸã‚«ã‚¹ã‚¿ãƒ ã‚­ãƒ¼ãƒã‚¤ãƒ³ãƒ‰ãŒé©ç”¨ã§ãã¾ã›ã‚“ã§ã—ãŸã€‚**ã‚‚ã—ã‚ã‹ã‚‹æ–¹ãŒã„ã‚‰ã£ã—ã‚ƒã‚Œã°ã€ã‚³ãƒ¡ãƒ³ãƒˆã—ã¦ã„ãŸã ã‘ã‚‹ã¨å¬‰ã—ã„ã§ã™ã€‚**

ãŸã ã€æ™®æ®µã‹ã‚‰ã‚ã¾ã‚Šä½¿ã‚ãªã„è¨­å®šã°ã‹ã‚Šãªã®ã§ãƒ€ãƒ¡ãƒ¼ã‚¸ã¯0ã§ã™ã€‚

```json:settings.jsonã®æŠœç²‹
    {
      "before": [
        "<Leader>",
        "m"
      ],
      "after": [
        "%"
      ]
    }
```

## ã•ã„ã”ã«

VSCode Neovimã«ç§»è¡Œã—ã¦ã‹ã‚‰ã¾ã 1æ—¥ã—ã‹çµŒã£ã¦ã„ã¾ã›ã‚“ãŒã€æŒ™å‹•ã®ã‚‚ã£ã•ã‚Šæ„Ÿã‚‚ãªããªã‚Šã€æ™®æ®µä½¿ã„ã®ã‚³ãƒãƒ³ãƒ‰ã¯ã™ã¹ã¦ä½¿ãˆã‚‹ã®ã§å¤§æº€è¶³ã§ã™ã€‚
ç§ã¯Vimãƒ©ã‚¤ãƒˆå±¤ãªã®ã§ã€VS Codeã§ä½¿ã†å ´åˆã¯ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’å…¥ã‚Œã‚‹é‹ç”¨ã‚’ã—ãªã„ã¤ã‚‚ã‚Šã§ã™ãŒã€è‰²ã€…ã¨ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã®ã—ãŒã„ãŒã‚ã‚Šãã†ã§è‰¯ã„æ‹¡å¼µæ©Ÿèƒ½ã ã¨æ€ã„ã¾ã—ãŸã€‚
